<!DOCTYPE html>

<html>
<head>
    <title>@ViewBag.Title</title>
    <link href="/modules/css/base.css" rel="stylesheet" />
    <link href="/modules/css/layout.css" rel="stylesheet" />
    <link rel="shortcut icon" href="../../modules/images/logo_login.png">
    @RenderSection("css", false)
</head>
<body>
    @{
        CloudSalesEntity.Users CurrentUser = (CloudSalesEntity.Users)Session["ClientManager"];
        string controller =  Url.RequestContext.RouteData.Values["controller"].ToString().ToUpper();
        string action = Url.RequestContext.RouteData.Values["action"].ToString().ToUpper();
        CloudSalesEntity.Menu controllerMenu = ExpandClass.GetController(HttpContext.Current, controller);
    }
    <header>
        <div class="logo left">
            <a href="/Home/Index"><img src="/modules/images/ico-home.png" /></a>
        </div>
        <div class="modules left" id="choosemodules">
            <div class="modulesname left">
                主菜单
            </div>
            <span class="right">
            </span>
        </div>
        <ul id="controllerMenu" class="menu left">
            @foreach (CloudSalesEntity.Menu model in ExpandClass.GetChildMenuByCode(HttpContext.Current, controllerMenu.PCode))
            { 
                <li class="left" data-code="@(model.MenuCode)">
                    <a class="@(model.Controller.ToUpper()==controller ? "select" : "")" href="/@(model.Controller)/@(model.View)">
                        <img data-ico="@(model.IcoPath)" data-hover="@(model.IcoHover)" src="@(model.IcoPath)" /> 
                        <span>@(model.Name)</span>
                    </a> 
                </li>
            }
        </ul>
        <div id="currentUser" class="currentuser right">
            <span>
                <img src="@(string.IsNullOrEmpty(CurrentUser.Avatar)?"/modules/images/defaultavatar.png":CurrentUser.Avatar)" class="avatar" />
            </span>
            <span class="username">
                @(CurrentUser.Name)
            </span>
            <span class="dropdown">
                <span class="dropdown-top"></span>
                <span class="dropdown-bottom"></span>
            </span>
        </div>
    </header>
    <div class="main-body">
        <nav>
            <div class="top-nav">
                <span class="controller-name">功能菜单</span>
            </div>
            <div class="nav-list">
                @foreach (CloudSalesEntity.Menu model in ExpandClass.GetChildMenuByCode(HttpContext.Current, controllerMenu.MenuCode))
                {
                    <ul class="action-box @(model.View.ToUpper()==action ? "select" : "")">
                        <li class="action "><a href="/@(model.Controller + "/" + model.View)" >@(model.Name)</a></li>
                    </ul>
                }
                
            </div>
            
        </nav>
        <div class="main-content">
            @RenderBody()
        </div>
    </div>
    @*点击头像展开下拉列表*@
    <div class="dropdown-userinfo hide">
        <div class="top-lump"></div>
        <ul class="items-list">
            <li class="item"><a href="/Home/Logout">安全退出</a></li>
        </ul>
    </div>
    <script type="text/javascript" src="/Scripts/sea.js"></script>
    <script type="text/javascript" src="/Scripts/sea-config.js"></script>
    <script type="text/javascript">
        seajs.use(["scripts/layout"], function (layout) {
            layout.init();
        });
    </script>
    @RenderSection("scripts", false)
</body>
    
</html>
